---
title: "08_correlation"
format: html
editor: visual
---

## Load differential expression data

```{r}
HER2 <- read_table("../data/diff_exp_HER2.tsv")
Luminal_A <- read_table("../data/diff_exp_Luminal_A.tsv")
Luminal_B <- read_table("../data/diff_exp_Luminal_B.tsv")
Basal_like <- read_table("../data/diff_exp_Basal_like.tsv")

```


Load and join clinical and protein data
```{r}
clinical_data <- read.table("../data/clinical_data.tsv", sep = "\t", header = T)

protein_data <- read.table("../data/count_matrix_1_77.tsv", header = T)
#pivot_longer(cols = -id, names_to = 'variable', values_to = 'value') |> 
 # pivot_wider(names_from = id, values_from = value) |> 
 # rename(id = variable)

full_data <- clinical_data |> 
  left_join(protein_data, by = "id")
```


Recode ER, PR, HER2
```{r}
full_data <- full_data |>
  mutate(significance = case_when(
    adjusted_fdr < 0.05 & estimate > 0 ~ "Significant positive influence", 
    adjusted_fdr < 0.05 & estimate < 0 ~ "Significant negative influence",
    TRUE ~"Not significant"
  ))


group_by
summarize(mean = mean(Sale_Price),
            std_err = sd(Sale_Price) / sqrt(length(Sale_Price)))
```



```{r}
HER2 <- HER2 |>
  mutate(significance = case_when(
    adjusted_fdr < 0.05 & estimate > 0 ~ "Significant positive influence", 
    adjusted_fdr < 0.05 & estimate < 0 ~ "Significant negative influence",
    TRUE ~"Not significant"
  ))

Basal_like <- Basal_like |>
  mutate(significance = case_when(
    adjusted_fdr < 0.05 & estimate > 0 ~ "Significant positive influence", 
    adjusted_fdr < 0.05 & estimate < 0 ~ "Significant negative influence",
    TRUE ~"Not significant"
  ))

Luminal_A <- Luminal_A |>
  mutate(significance = case_when(
    adjusted_fdr < 0.05 & estimate > 0 ~ "Significant positive influence", 
    adjusted_fdr < 0.05 & estimate < 0 ~ "Significant negative influence",
    TRUE ~"Not significant"
  ))

Luminal_B <- Luminal_B |>
  mutate(significance = case_when(
    adjusted_fdr < 0.05 & estimate > 0 ~ "Significant positive influence", 
    adjusted_fdr < 0.05 & estimate < 0~ "Significant negative influence",
    TRUE ~"Not significant"
  ))
```


Extract significant proteins
```{r}




full_data |> 
  pivot_longer(cols = -id, names_to = 'variable', values_to = 'value'))
  filter ()
```





